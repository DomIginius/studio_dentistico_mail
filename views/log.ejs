<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <title>Email Logs</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      defer
    ></script>
    <style>
      body {
        background-color: #f8f9fa;
        font-family: Arial, sans-serif;
      }
      .page-title {
        font-size: 2rem;
        font-weight: bold;
      }
      .logs-table {
        background-color: #ffffff;
        padding: 1rem;
        border-radius: 0.5rem;
        box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
      }
      .badge-success {
        background-color: #198754;
      }
      .badge-error {
        background-color: #dc3545;
      }
      .badge-info {
        background-color: #0dcaf0;
      }
      .truncate {
        max-width: 200px;
        display: inline-block;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
    </style>
  </head>
  <body>
    <main class="container py-4">
      <h1 class="page-title mb-4 text-center">Log Email Invii</h1>

      <div class="logs-table table-responsive">
        <table class="table table-striped table-hover align-middle mb-0">
          <thead>
            <tr>
              <th
                class="text-center text-uppercase text-muted small fw-semibold"
              >
                ID
              </th>
              <th
                class="text-center text-uppercase text-muted small fw-semibold"
              >
                Nome
              </th>
              <th
                class="text-center text-uppercase text-muted small fw-semibold"
              >
                Telefono
              </th>
              <th
                class="text-center text-uppercase text-muted small fw-semibold"
              >
                Timestamp
              </th>
              <th
                class="text-center text-uppercase text-muted small fw-semibold"
              >
                Stato
              </th>
              <th
                class="text-center text-uppercase text-muted small fw-semibold"
              >
                MessageId
              </th>
              <th
                class="text-center text-uppercase text-muted small fw-semibold"
              >
                Errore
              </th>
            </tr>
          </thead>
          <tbody>
            <% logs.forEach((log) => { %>
            <tr>
              <td class="text-center"><%= log.id %></td>
              <td class="text-center"><%= log.nome %></td>
              <td class="text-center"><%= log.telefono %></td>
              <td class="text-center">
                <%= new Date(log.timestamp).toLocaleString('it-IT') %>
              </td>
              <td class="text-center">
                <span
                  class="badge <%= log.stato === 'SUCCESS' ? 'badge-success' : 'badge-error' %>"
                >
                  <%= log.stato %>
                </span>
              </td>
              <td class="text-center"><%= log.messageId || '-' %></td>
              <td class="text-center"><%= log.errorMessage || '-' %></td>
            </tr>
            <% }) %>
          </tbody>
        </table>
      </div>
    </main>
  </body>
</html>
